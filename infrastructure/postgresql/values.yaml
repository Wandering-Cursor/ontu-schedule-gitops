# PostgreSQL configuration
# This is a wrapper chart that deploys the official Bitnami PostgreSQL Helm chart

postgresql:
  # Global configuration
  global:
    postgresql:
      auth:
        # Username for the PostgreSQL database
        username: ontu_user
        # Database name
        database: ontu_schedule
        # Existing secret with PostgreSQL credentials (use Sealed Secrets)
        # If not specified, a random password will be generated
        existingSecret: ""
        # Key in the secret containing the password
        secretKeys:
          adminPasswordKey: postgres-password
          userPasswordKey: password
  
  # PostgreSQL primary configuration
  primary:
    # Persistence for PostgreSQL data
    persistence:
      enabled: true
      storageClass: ""
      size: 10Gi
    
    # Resource limits
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 250m
        memory: 256Mi
    
    # Pod security context
    podSecurityContext:
      enabled: true
      fsGroup: 1001
    
    containerSecurityContext:
      enabled: true
      runAsUser: 1001
      runAsNonRoot: true
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
  
  # Metrics configuration
  metrics:
    enabled: true
    serviceMonitor:
      enabled: false
    resources:
      limits:
        cpu: 100m
        memory: 128Mi
      requests:
        cpu: 50m
        memory: 64Mi
  
  # Volume permissions init container
  volumePermissions:
    enabled: false
  
  # Backup configuration (optional)
  backup:
    enabled: false
    cronjob:
      schedule: "0 2 * * *"
      storage:
        size: 10Gi
