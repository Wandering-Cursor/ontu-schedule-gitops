# Example NGINX Application Configuration
# This example demonstrates how to use secrets, environment variables, and ConfigMaps

# NGINX image configuration
image:
  repository: nginx
  tag: "1.25-alpine"
  pullPolicy: IfNotPresent

# Number of replicas
replicaCount: 1

# Service configuration
service:
  type: ClusterIP
  port: 80

# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    # Example annotation for SSL redirect
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts:
    - host: example.local
      paths:
        - path: /
          pathType: Prefix
  tls: []
    # Uncomment to enable TLS
    # - secretName: example-nginx-tls
    #   hosts:
    #     - example.local

# Resource limits
resources:
  requests:
    cpu: 10m
    memory: 16Mi
  limits:
    cpu: 50m
    memory: 64Mi

# Configuration examples
config:
  # Non-sensitive configuration
  # These will be available as environment variables
  APP_NAME: "Example NGINX App"
  APP_VERSION: "1.0.0"
  ENVIRONMENT: "production"
  LOG_LEVEL: "info"
  MAX_CONNECTIONS: "100"
  CACHE_ENABLED: "true"

# Secrets configuration
secrets:
  # NOTE: In production, these should be SealedSecrets!
  # These are just examples - replace with actual sealed secrets
  
  # API key example
  API_KEY: "changeme-api-key-12345"
  
  # Database password example
  DB_PASSWORD: "changeme-db-password"
  
  # JWT secret example
  JWT_SECRET: "changeme-jwt-secret-key"
  
  # External service credentials
  EXTERNAL_SERVICE_TOKEN: "changeme-service-token"

# Custom NGINX configuration
nginxConfig: |
  server {
      listen 80;
      server_name localhost;
      
      # Serve static content
      location / {
          root /usr/share/nginx/html;
          index index.html;
      }
      
      # Health check endpoint
      location /health {
          access_log off;
          return 200 "healthy\n";
          add_header Content-Type text/plain;
      }
      
      # Example proxy to backend (if needed)
      # location /api {
      #     proxy_pass http://backend-service:8080;
      #     proxy_set_header Host $host;
      #     proxy_set_header X-Real-IP $remote_addr;
      # }
  }

# Custom HTML content to demonstrate environment variables
htmlContent: |
  <!DOCTYPE html>
  <html>
  <head>
      <title>Example NGINX Application</title>
      <style>
          body {
              font-family: Arial, sans-serif;
              max-width: 800px;
              margin: 50px auto;
              padding: 20px;
              background-color: #f5f5f5;
          }
          .container {
              background-color: white;
              padding: 30px;
              border-radius: 8px;
              box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          }
          h1 { color: #333; }
          .info { margin: 20px 0; }
          .label { font-weight: bold; color: #666; }
          .value { color: #0066cc; }
          .secret { color: #cc0000; font-family: monospace; }
          code { background-color: #f4f4f4; padding: 2px 6px; border-radius: 3px; }
      </style>
  </head>
  <body>
      <div class="container">
          <h1>üéâ Example NGINX Application</h1>
          <p>This is a demo application showing how to use Helm charts with:</p>
          <ul>
              <li>ConfigMaps for configuration</li>
              <li>Secrets for sensitive data</li>
              <li>Environment variables</li>
              <li>Custom NGINX configuration</li>
              <li>Sealed Secrets (in production)</li>
          </ul>
          
          <div class="info">
              <div><span class="label">Application:</span> <span class="value">Example NGINX App</span></div>
              <div><span class="label">Version:</span> <span class="value">1.0.0</span></div>
              <div><span class="label">Environment:</span> <span class="value">Production</span></div>
          </div>
          
          <h2>üìã Configuration Examples</h2>
          <p>Environment variables are loaded from ConfigMap:</p>
          <ul>
              <li><code>APP_NAME</code>: Set via ConfigMap</li>
              <li><code>APP_VERSION</code>: Set via ConfigMap</li>
              <li><code>ENVIRONMENT</code>: Set via ConfigMap</li>
              <li><code>LOG_LEVEL</code>: Set via ConfigMap</li>
          </ul>
          
          <h2>üîê Secrets Examples</h2>
          <p>Sensitive data is loaded from Secrets (use SealedSecrets in production!):</p>
          <ul>
              <li><code>API_KEY</code>: <span class="secret">***hidden***</span></li>
              <li><code>DB_PASSWORD</code>: <span class="secret">***hidden***</span></li>
              <li><code>JWT_SECRET</code>: <span class="secret">***hidden***</span></li>
          </ul>
          
          <h2>üìö Documentation</h2>
          <p>See the chart's README for:</p>
          <ul>
              <li>How to create SealedSecrets</li>
              <li>How to customize configuration</li>
              <li>How to deploy this application</li>
          </ul>
          
          <h2>‚úÖ Health Check</h2>
          <p>Health endpoint: <a href="/health">/health</a></p>
      </div>
  </body>
  </html>
